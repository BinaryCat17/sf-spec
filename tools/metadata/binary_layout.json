{
  "file_format": "SionFlow Cartridge",
  "extension": ".sfc",
  "magic": "0x4D464C57",
  "version": 20,
  "structures": {
    "sf_cartridge_header": {
      "alignment": 64,
      "fields": [
        { "name": "magic", "type": "u32" },
        { "name": "version", "type": "u32" },
        { "name": "app_title", "type": "char", "array": 128 },
        { "name": "window_width", "type": "u32" },
        { "name": "window_height", "type": "u32" },
        { "name": "num_threads", "type": "u32" },
        { "name": "vsync", "type": "u8" },
        { "name": "fullscreen", "type": "u8" },
        { "name": "resizable", "type": "u8" },
        { "name": "reserved_flags", "type": "u8", "array": 1 },
        { "name": "section_count", "type": "u32" },
        { "name": "sections", "type": "sf_section_header", "array": 16 },
        { "name": "reserved", "type": "u32", "array": 8 }
      ]
    },
    "sf_section_header": {
      "alignment": 16,
      "fields": [
        { "name": "name", "type": "char", "array": 64 },
        { "name": "type", "type": "u32" },
        { "name": "offset", "type": "u32" },
        { "name": "size", "type": "u32" },
        { "name": "reserved", "type": "u32", "array": 4 }
      ]
    },
    "sf_bin_header": {
      "alignment": 64,
      "fields": [
        { "name": "instruction_count", "type": "u32" },
        { "name": "tensor_count", "type": "u32" },
        { "name": "symbol_count", "type": "u32" },
        { "name": "task_count", "type": "u32" },
        { "name": "binding_count", "type": "u32" },
        { "name": "reduction_scratch_size", "type": "u32" },
        { "name": "sync_scratch_size", "type": "u32" },
        { "name": "push_constants_size", "type": "u32" },
        { "name": "reserved", "type": "u32", "array": 7 }
      ]
    }
  },
  "cartridge_layout": [
    { "id": "header", "type": "sf_cartridge_header" },
    { "id": "section_data", "type": "blob", "count": "header.section_count", "alignment": 64 }
  ],
  "program_layout": [
    { "id": "header", "type": "sf_bin_header" },
    { "id": "symbols", "type": "sf_bin_symbol", "count": "meta.symbol_count", "alignment": 16 },
    { "id": "tasks", "type": "sf_task", "count": "meta.task_count", "alignment": 16 },
    { "id": "bindings", "type": "sf_bin_task_binding", "count": "meta.binding_count", "alignment": 16 },
    { "id": "tensor_descs", "type": "sf_bin_tensor_desc", "count": "meta.tensor_count", "alignment": 16 },
    { "id": "instructions", "type": "sf_instruction", "count": "meta.instruction_count", "alignment": 16 },
    { "id": "push_constants", "type": "u8", "count": "meta.push_constants_size", "alignment": 16 },
    { "id": "constant_blobs", "type": "raw", "count": "variable", "alignment": 64 }
  ]
}